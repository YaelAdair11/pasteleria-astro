<div class="container-fluid py-3 bg-light">
  <div class="d-flex gap-2 align-items-center flex-wrap">

    <div class="col-12 col-lg-auto">
      <div class="input-group">
        <span class="input-group-text bg-white">
          <i class="fa-solid fa-magnifying-glass"></i>
        </span>
        <input type="text" class="form-control" placeholder="Buscar producto..." (input)="buscar($event)">
      </div>
    </div>

    <div class="">
      <select class="form-select" (change)="filtrarActivo($event)">
        <option value="">Todos los productos</option>
        <option value="true">Activos</option>
        <option value="false">Inactivos</option>
      </select>
    </div>

    <div class="">
      <select class="form-select" (change)="filtrarCategoria($event)">
        <option value="">Todas las categorías</option>
        <option *ngFor="let c of categorias" [value]="c.id">{{ c.nombre }}</option>
        <option value="__NUEVA__" class="text-primary fw-semibold">Crear categoría</option>
      </select>
    </div>

    <button class="btn btn-primary align-items-center ms-auto" (click)="abrirModalCrear()">
      <i class="fa-solid fa-plus me-0 me-md-2"></i>
      <span class="d-none d-md-inline" style="font-weight: 600;">Agregar Producto</span>
    </button>
  </div>

  <div class="table-responsive mt-3 p-2 border rounded-4 bg-white shadow-sm">
    <table class="table table-hover table-borderless align-middle">
      <thead class="table-light text-muted">
        <tr class="text-center text-muted">
          <th class="text-start p-3">PRODUCTO</th>
          <th class="p-3">CATEGORÍA</th>
          <th class="p-3">STOCK</th>
          <th class="p-3">PRECIO</th>
          <th class="p-3">ACTIVO</th>
          <th class="p-3">ACCIONES</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let p of productos" class="text-center">
          <td class="d-flex align-items-center gap-3">
            <img *ngIf="p.imagen" [src]="p.imagen" class="object-fit-cover"
              style="width: 4rem; height: 4rem;" (error)="p.imagen = undefined">
            <div *ngIf="!p.imagen" class="rounded-circle text-white fw-bold d-flex justify-content-center align-items-center"
              [style.background]="colorAleatorio(p.nombre)"
              style="font-size: 1.3rem; width: 4rem; height: 4rem;">
              {{ p.nombre.charAt(0).toUpperCase() }}
            </div>
            <span>{{ p.nombre }}</span>
          </td>
          <td>{{ getNombreCategoria(p.categoria_id) }}</td>
          <td>{{ p.stock }}</td>
          <td>${{ p.precio }}</td>
          <td>
            <div class="form-check form-switch d-flex justify-content-center">
              <input type="checkbox" class="form-check-input" [checked]="p.activo">
            </div>
          </td>
          <td>
            <div class="d-flex gap-2 justify-content-center">
              <button class="btn btn-sm border-0" (click)="abrirModalEditar(p)">
                <i class="fa-solid fa-pen"></i>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
